<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>FTT</title>
  
  <subtitle>Fun tech times</subtitle>
  <link href="https://darknessnerd.github.io.git/atom.xml" rel="self"/>
  
  <link href="https://darknessnerd.github.io.git/"/>
  <updated>2024-08-08T00:31:21.824Z</updated>
  <id>https://darknessnerd.github.io.git/</id>
  
  <author>
    <name>Brunino Criniti</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>The Day I Became a Weather Guru</title>
    <link href="https://darknessnerd.github.io.git/2024/08/08/The-Day-I-Became-a-Weather-Wizard/"/>
    <id>https://darknessnerd.github.io.git/2024/08/08/The-Day-I-Became-a-Weather-Wizard/</id>
    <published>2024-08-07T22:00:00.000Z</published>
    <updated>2024-08-08T00:31:21.824Z</updated>
    
    <content type="html"><![CDATA[<h1 id="The-Day-I-Became-a-Weather-Wizard-üå©Ô∏èüßô‚Äç‚ôÇÔ∏è"><a href="#The-Day-I-Became-a-Weather-Wizard-üå©Ô∏èüßô‚Äç‚ôÇÔ∏è" class="headerlink" title="The Day I Became a Weather Wizard üå©Ô∏èüßô‚Äç‚ôÇÔ∏è"></a>The Day I Became a Weather Wizard üå©Ô∏èüßô‚Äç‚ôÇÔ∏è</h1><p>Want to outsmart your local weatherman with cool gadgets and tech wizardry? üßô‚Äç‚ôÇÔ∏èü™Ñ Grab your wizard hat and staff because I‚Äôm about to show you how I set up my own weather station using a <strong>Bresser Weather Center 5-in-1</strong>, a radio receiver, and a bunch of software tools that made me feel like a tech overlord. üå¶Ô∏èüì°üíªüëë</p><h2 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h2><p>Our grand quest includes stopping the system irrigation when it rains and managing the thermostat based on the outside temperature and room temperatures. </p><p>In the realm of home automation, only your imagination sets the boundaries.</p><p>SPOILER: We‚Äôll achieve all this by the end of the tutorial!</p><p><img src="/2024/08/08/The-Day-I-Became-a-Weather-Wizard/weather_screen.gif" alt="Real-time weather dashboard" title="Hass Home"></p><h2 id="High-Level-System-Overview"><a href="#High-Level-System-Overview" class="headerlink" title="High-Level System Overview"></a>High-Level System Overview</h2><p><img src="/2024/08/08/The-Day-I-Became-a-Weather-Wizard/archi.gif" alt="High level system overview" title="High level system overview"></p><h2 id="The-Hardware-üõ†Ô∏è"><a href="#The-Hardware-üõ†Ô∏è" class="headerlink" title="The Hardware üõ†Ô∏è"></a>The Hardware üõ†Ô∏è</h2><p><img src="/2024/08/08/The-Day-I-Became-a-Weather-Wizard/hardware.png" alt="hardware" title="hardware"></p><h3 id="The-Weather-Sensors"><a href="#The-Weather-Sensors" class="headerlink" title="The Weather Sensors"></a>The Weather Sensors</h3><p>First up, meet the star of the show, the <strong>Bresser Weather Center 5-in-1</strong>. It‚Äôs not just a fancy name; it‚Äôs a fancy gadget listed in the prestigious <a href="https://github.com/merbanan/rtl_433">rtl_433 GitHub repo</a>.</p><p>For more details, check it out <a href="https://www.bresser.de/en/Weather-Time/BRESSER-Wi-Fi-Colour-Weather-Station-with-5-in-1-Professional-Sensor.html">here</a>.</p><h3 id="Room-Sensors"><a href="#Room-Sensors" class="headerlink" title="Room Sensors"></a>Room Sensors</h3><p>We‚Äôre also using some room sensors to keep track of indoor temperatures and humidity: <a href="https://www.bresser.de/en/Weather-Time/Weather-Stations/BRESSER-Thermo-Hygrometer-Quadro-with-4-Independent-Measuring-Details.html">Bresser Thermo Hygrometer Quadro</a>.</p><h3 id="A-Radio-Receiver"><a href="#A-Radio-Receiver" class="headerlink" title="A Radio Receiver"></a>A Radio Receiver</h3><p>To catch those sweet 433 MHz or 868,3 MHz signals from the weather station, I dusted off an old radio receiver.<br>Think of it as bringing an old friend back to the spotlight.<br>(And by ‚Äúold friend,‚Äù I mean a piece of tech I had lying around from a previous project.)</p><h3 id="Something-to-Run-the-Show"><a href="#Something-to-Run-the-Show" class="headerlink" title="Something to Run the Show"></a>Something to Run the Show</h3><p>To make all this magic happen, I needed something robust to run <strong>Home Assistant</strong>, <strong>Mosquitto</strong>, <strong>InfluxDB</strong>, and <strong>Grafana</strong>. You know, the usual suspects in the smart home scene.</p><h2 id="Setting-Up-the-Weather-Station"><a href="#Setting-Up-the-Weather-Station" class="headerlink" title="Setting Up the Weather Station"></a>Setting Up the Weather Station</h2><p>Mounting the weather station was like setting up a fancy birdhouse, except this one tells you when to carry an umbrella.</p><p>Once mounted, it started beaming data like a weather-obsessed R2-D2. Now, to catch those signals!</p><h2 id="Setting-Up-Home-Assistant"><a href="#Setting-Up-Home-Assistant" class="headerlink" title="Setting Up Home Assistant"></a>Setting Up Home Assistant</h2><p>Follow <a href="https://www.home-assistant.io/getting-started/">this guide</a> to get Home Assistant up and running. </p><p>Once you‚Äôve got it set up, you‚Äôre halfway to becoming a weather oracle.</p><h2 id="A-Quick-Dive-into-RTL-SDR"><a href="#A-Quick-Dive-into-RTL-SDR" class="headerlink" title="A Quick Dive into RTL-SDR"></a>A Quick Dive into RTL-SDR</h2><p><strong>RTL-SDR</strong> is the superhero we need but don‚Äôt deserve. Originally created for decoding HDTV signals with the RTL2832U chipset from RealTek, it now serves a higher purpose: letting us eavesdrop on RF signals. From weather stations to tire pressure sensors, if it‚Äôs on 433 MHz, rtl_433 can hear it.</p><h2 id="Docker-Compose-to-the-Rescue-üê≥"><a href="#Docker-Compose-to-the-Rescue-üê≥" class="headerlink" title="Docker Compose to the Rescue üê≥"></a>Docker Compose to the Rescue üê≥</h2><h3 id="Home-Assistant-Mosquitto-and-PostgreSQL"><a href="#Home-Assistant-Mosquitto-and-PostgreSQL" class="headerlink" title="Home Assistant, Mosquitto, and PostgreSQL"></a>Home Assistant, Mosquitto, and PostgreSQL</h3><p>Here‚Äôs the secret sauce to run Home Assistant, Mosquitto, and PostgreSQL using Docker Compose:</p><p>This section defines each service (container) that makes up the application.</p><p>Here‚Äôs an explanation of your Docker Compose file with comments:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.9&#x27;</span>  <span class="comment"># Specifies the version of the Docker Compose file format</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span>  <span class="comment"># Defines the services (containers) that will be managed by Docker Compose</span></span><br><span class="line">  <span class="attr">homeassistant:</span>  <span class="comment"># Name of the service</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">homeassistant</span>  <span class="comment"># Name of the container</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&quot;ghcr.io/home-assistant/home-assistant:2024.7.4&quot;</span>  <span class="comment"># Docker image and version to use for this service</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/home/muadib/home/hass:/config</span>  <span class="comment"># Mounts the local directory for Home Assistant configuration</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span>  <span class="comment"># Synchronizes the container&#x27;s time with the host&#x27;s time (read-only)</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/run/docker.sock:/var/run/docker.sock</span> <span class="comment">#for monitor docker # Allows Home Assistant to monitor Docker (requires Docker socket access)</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span>  <span class="comment"># Ensures the container restarts automatically unless it is explicitly stopped</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">host</span>  <span class="comment"># Shares the host&#x27;s network stack (allows access to the host network directly)</span></span><br><span class="line">    <span class="attr">depends_on:</span>  <span class="comment"># Specifies dependencies on other services</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mosquitto</span>  <span class="comment"># This service depends on the Mosquitto service</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">postgres</span>  <span class="comment"># This service depends on the Postgres service</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">influxdb</span>  <span class="comment"># This service depends on the InfluxDB service</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">postgres:</span>  <span class="comment"># Name of the service</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">postgres</span>  <span class="comment"># Name of the container</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:16.3-alpine3.20</span>  <span class="comment"># Docker image and version to use for this service</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span>  <span class="comment"># Ensures the container restarts automatically unless it is explicitly stopped</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5432</span><span class="string">:5432</span>  <span class="comment"># Maps the host port 5432 to the container port 5432 (default PostgreSQL port)</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/home/muadib/home/postgres:/var/lib/postgresql/data</span>  <span class="comment"># Mounts the local directory for PostgreSQL data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span>  <span class="comment"># Synchronizes the container&#x27;s time with the host&#x27;s time (read-only)</span></span><br><span class="line">    <span class="attr">environment:</span>  <span class="comment"># Environment variables for the PostgreSQL service</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_DB=homeassistant</span>  <span class="comment"># Name of the default database</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_USER=hass</span>  <span class="comment"># PostgreSQL user</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_PASSWORD=hass</span>  <span class="comment"># PostgreSQL user&#x27;s password</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">mosquitto:</span>  <span class="comment"># Name of the service</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mosquitto</span>  <span class="comment"># Name of the container</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">eclipse-mosquitto:2.0.18</span>  <span class="comment"># Docker image and version to use for this service</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">1883</span><span class="string">:1883</span> <span class="comment">#default mqtt port  # Maps the host port 1883 to the container port 1883 (default MQTT port)</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/home/muadib/home/mosquitto/mosquitto_conf:/mosquitto/config</span>  <span class="comment"># Mounts the local directory for Mosquitto configuration</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/home/muadib/home/mosquitto/mosquitto_data:/mosquitto/data</span>  <span class="comment"># Mounts the local directory for Mosquitto data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/home/muadib/home/mosquitto/mosquitto_log:/mosquitto/log</span>  <span class="comment"># Mounts the local directory for Mosquitto logs</span></span><br></pre></td></tr></table></figure><h3 id="Key-Points"><a href="#Key-Points" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul><li><strong>version</strong>: Specifies the version of the Docker Compose file format.</li><li><strong>services</strong>: Lists all the services to be managed by Docker Compose.<ul><li><strong>container_name</strong>: Sets a custom name for the container.</li><li><strong>image</strong>: Defines the Docker image to use for the container.</li><li><strong>volumes</strong>: Mounts directories from the host to the container for persistent storage and configuration.</li><li><strong>restart</strong>: Determines the restart policy for the container.</li><li><strong>network_mode</strong>: Configures the container to use the host‚Äôs network stack directly.</li><li><strong>depends_on</strong>: Specifies dependencies between services to control the order of startup.</li><li><strong>ports</strong>: Maps ports between the host and the container.</li><li><strong>environment</strong>: Sets environment variables for the container.</li></ul></li></ul><p>This configuration sets up a multi-container environment for running Home Assistant along with supporting services like PostgreSQL (database) and Mosquitto (MQTT broker). Each service has its own container with specified configurations, dependencies, and volume mappings to ensure persistent storage and appropriate networking.</p><h3 id="Configure-Mosquitto"><a href="#Configure-Mosquitto" class="headerlink" title="Configure Mosquitto"></a>Configure Mosquitto</h3><p>First, let‚Äôs set up Mosquitto:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /home/muadib/home/mosquitto/mosquitto_conf/mosquitto.conf</span><br></pre></td></tr></table></figure><p>Add the following lines:</p><p>This <code>ini</code> configuration file is likely for Mosquitto, an open-source MQTT (Message Queuing Telemetry Transport) broker. Each parameter controls a different aspect of the Mosquitto broker‚Äôs behavior. Here‚Äôs an explanation of each line, along with comments to describe their purpose:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">persistence true  </span><br><span class="line"><span class="comment"># Enables persistent storage of messages and subscriptions. </span></span><br><span class="line"><span class="comment"># This means that the broker will store messages and subscriptions on disk, </span></span><br><span class="line"><span class="comment"># so they are not lost if the broker is restarted.  persistence_location </span></span><br><span class="line">/mosquitto/data  </span><br><span class="line"><span class="comment"># Specifies the directory where the persistent data will be stored. </span></span><br><span class="line"><span class="comment"># In this case, the data will be stored in the /mosquitto/data directory.  </span></span><br><span class="line">log_dest file /mosquitto/log/mosquitto.log  </span><br><span class="line"><span class="comment"># Sets the destination for log messages. </span></span><br><span class="line"><span class="comment"># &#x27;file&#x27; means the log messages will be written to a file. </span></span><br><span class="line"><span class="comment"># The path /mosquitto/log/mosquitto.log is the file where the log messages will be stored.  </span></span><br><span class="line">log_type information  </span><br><span class="line"><span class="comment"># Specifies the type of messages to be logged. </span></span><br><span class="line"><span class="comment"># &#x27;information&#x27; indicates that informational messages will be logged. </span></span><br><span class="line"><span class="comment"># Other options might include debug, notice, warning, error, etc.  </span></span><br><span class="line">listener 1883  </span><br><span class="line"><span class="comment"># Defines a network listener on port 1883. </span></span><br><span class="line"><span class="comment"># This is the default port for MQTT and is typically used for unencrypted MQTT connections.  </span></span><br><span class="line"><span class="comment">## Authentication ##  </span></span><br><span class="line"><span class="comment"># The following settings are related to authentication and access control.  </span></span><br><span class="line">allow_anonymous false  </span><br><span class="line"><span class="comment"># Disables anonymous access. </span></span><br><span class="line"><span class="comment"># Clients must provide a valid username and password to connect to the broker.  </span></span><br><span class="line">password_file /mosquitto/config/mosquitto.passwd </span><br><span class="line"><span class="comment"># Specifies the file that contains the usernames and passwords for authentication. </span></span><br><span class="line"><span class="comment"># The file /mosquitto/config/mosquitto.passwd should contain the credentials for users allowed to connect.</span></span><br></pre></td></tr></table></figure><h4 id="Summary"><a href="#Summary" class="headerlink" title="Summary:"></a>Summary:</h4><ul><li><strong>persistence</strong>: Enables the retention of messages and subscriptions.</li><li><strong>persistence_location</strong>: Specifies the directory for storing persistent data.</li><li><strong>log_dest</strong>: Defines where log messages should be sent.</li><li><strong>log_type</strong>: Specifies the type of log messages.</li><li><strong>listener</strong>: Configures the network port the broker listens on for incoming connections.</li><li><strong>allow_anonymous</strong>: Controls whether anonymous connections are allowed.</li><li><strong>password_file</strong>: Points to the file containing user authentication credentials.</li></ul><p>These settings help configure the Mosquitto broker to store data persistently, log operational information, listen for incoming MQTT connections on the standard port, and enforce user authentication.</p><h4 id="Create-the-user-and-set-the-password"><a href="#Create-the-user-and-set-the-password" class="headerlink" title="Create the user and set the password:"></a>Create the user and set the password:</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /home/muadib/home/mosquitto/mosquitto_conf/mosquitto.passwd</span><br></pre></td></tr></table></figure><p>Enter your desired username and password in the following format:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username:password</span><br></pre></td></tr></table></figure><p>Spin it up and run this command for the password file encryption:</p><h5 id="Command-1-docker-compose-up-d"><a href="#Command-1-docker-compose-up-d" class="headerlink" title="Command 1: docker-compose up -d"></a>Command 1: <code>docker-compose up -d</code></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><ul><li><code>docker-compose</code>: This is the command to interact with Docker Compose, a tool for defining and running multi-container Docker applications.</li><li><code>up</code>: This subcommand tells Docker Compose to build, (re)create, start, and attach to containers for a service.</li><li><code>-d</code>: This flag stands for ‚Äúdetached mode,‚Äù meaning the containers will run in the background.</li></ul><h4 id="Command-2-docker-compose-exec-mosquitto-mosquitto-passwd-U-mosquitto-config-mosquitto-passwd"><a href="#Command-2-docker-compose-exec-mosquitto-mosquitto-passwd-U-mosquitto-config-mosquitto-passwd" class="headerlink" title="Command 2: docker-compose exec mosquitto mosquitto_passwd -U /mosquitto/config/mosquitto.passwd"></a>Command 2: <code>docker-compose exec mosquitto mosquitto_passwd -U /mosquitto/config/mosquitto.passwd</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose <span class="built_in">exec</span> mosquitto mosquitto_passwd -U /mosquitto/config/mosquitto.passwd</span><br></pre></td></tr></table></figure><ul><li><code>docker-compose</code>: Again, this is the command to interact with Docker Compose.</li><li><code>exec</code>: This subcommand runs a command in a running service container.</li><li><code>mosquitto</code>: The name of the service&#x2F;container where the command should be executed.</li><li><code>mosquitto_passwd</code>: This is the command within the Mosquitto container used to manage Mosquitto password files.</li><li><code>-U</code>: This flag updates the password file, re-encrypting any plain text passwords.</li><li><code>/mosquitto/config/mosquitto.passwd</code>: The path to the Mosquitto password file within the container.</li></ul><h3 id="RTL-433-Docker-Compose-Setup"><a href="#RTL-433-Docker-Compose-Setup" class="headerlink" title="RTL_433 Docker Compose Setup"></a>RTL_433 Docker Compose Setup</h3><p>First, identify the USB device:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ./ports.sh</span><br></pre></td></tr></table></figure><p>This will output something like:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/dev/bus/usb/001/001 - Linux_6.6.31+rpt-rpi-v8_dwc_otg_hcd_DWC_OTG_Controller_3f980000.usb </span><br><span class="line">/dev/bus/usb/001/005 - Realtek_RTL2838UHIDIR_00000001 </span><br><span class="line">/dev/swradio0 - Realtek_RTL2838UHIDIR_00000001</span><br></pre></td></tr></table></figure><p>Our device is <code>/dev/bus/usb/001/005</code>.</p><p>Now, create the Docker Compose file for RTL_433:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.3&#x27;</span> <span class="comment"># Specifies the version of the Docker Compose file format</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">rtl-433:</span> <span class="comment"># Defines a service named rtl-433</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&#x27;hertzg/rtl_433:23.11-alpine&#x27;</span> <span class="comment"># Uses the hertzg/rtl_433 image, version 23.11-alpine</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">rtl-433</span> <span class="comment"># Sets the hostname of the container to rtl-433</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">rtl-433</span> <span class="comment"># Names the container rtl-433</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span> <span class="comment"># Automatically restarts the container unless it is explicitly stopped</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">host</span> <span class="comment"># Uses the host&#x27;s network stack</span></span><br><span class="line">    <span class="attr">volumes:</span> <span class="comment"># Mounts host directories into the container</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span> <span class="comment"># Mounts the host&#x27;s localtime file as read-only</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/timezone:/etc/timezone:ro</span> <span class="comment"># Mounts the host&#x27;s timezone file as read-only</span></span><br><span class="line">    <span class="attr">devices:</span> <span class="comment"># Grants the container access to the specified device</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/dev/bus/usb/001/004</span> <span class="comment"># Path to the USB device on the host</span></span><br><span class="line">    <span class="attr">command:</span> <span class="comment"># Specifies the command to run in the container</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-f868300000&#x27;</span> <span class="comment"># Frequency to listen on: 868.3 MHz</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-f433920000&#x27;</span> <span class="comment"># Frequency to listen on: 433.92 MHz</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-H160&#x27;</span> <span class="comment"># Protocol number 160 to be used by rtl_433</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-s1M&#x27;</span> <span class="comment"># Sample rate: 1 million samples per second</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Yautolevel&#x27;</span> <span class="comment"># Enable automatic gain adjustment</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Yminmax&#x27;</span> <span class="comment"># Display minimum and maximum signal level</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Ymagest&#x27;</span> <span class="comment"># Show magnitude estimation</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Mlevel&#x27;</span> <span class="comment"># Display signal level</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Mnoise&#x27;</span> <span class="comment"># Display noise level</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Mtime:unix:usec:utc&#x27;</span> <span class="comment"># Display time in Unix format with microseconds and UTC timezone</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Mbits&#x27;</span> <span class="comment"># Display bit-level information</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Mprotocol&#x27;</span> <span class="comment"># Display protocol information</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Ccustomary&#x27;</span> <span class="comment"># Use customary units for output</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Mstats:2:300&#x27;</span> <span class="comment"># Display statistics every 2 seconds, reset every 300 seconds</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;-Fmqtt://192.168.1.71:1883,retain=1,user=rtl,pass=rtl&#x27;</span> <span class="comment"># Send data to the MQTT broker at 192.168.1.71 on port 1883 with retain flag set and specified user credentials</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>This configuration sets up a Docker container for the rtl_433 software, which is used for receiving and decoding data from various radio transmitters, and sends the decoded data to an MQTT broker.</p><p>In my setup, I needed to scan two frequencies: one for room sensors and one for the weather station.</p><p>Fire it up:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up</span><br></pre></td></tr></table></figure><p>You‚Äôll see:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rtl-<span class="number">433</span>    | rtl_433 version <span class="number">23.11</span> branch  at <span class="number">202311281352</span> inputs file rtl_tcp RTL-SDR with TLS </span><br><span class="line">rtl-<span class="number">433</span>    | MQTT: Publishing MQTT data to localhost port <span class="number">1883</span> </span><br><span class="line">rtl-<span class="number">433</span>    | Use <span class="string">&quot;-F log&quot;</span> <span class="keyword">if</span> you want any messages, warnings, and errors in the console. </span><br><span class="line">rtl-<span class="number">433</span>    | Detached kernel driver </span><br><span class="line">rtl-<span class="number">433</span>    | Found Rafael Micro R820T tuner </span><br><span class="line">rtl-<span class="number">433</span>    | Exact sample rate is: <span class="number">1000000.026491</span> Hz rtl-<span class="number">433</span>    | [R82XX] PLL not locked!</span><br></pre></td></tr></table></figure><h3 id="Home-Assistant-Add-on"><a href="#Home-Assistant-Add-on" class="headerlink" title="Home Assistant Add-on"></a>Home Assistant Add-on</h3><p>Extend the Docker Compose for RTL with this:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  <span class="attr">rtl_433_autodiscovery:</span></span><br><span class="line">    <span class="attr">profiles:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">donotstart</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">rtl_433_autodiscovery</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">ghcr.io/pbkhrv/rtl_433-hass-addons-rtl_433_mqtt_autodiscovery-aarch64:next</span> <span class="comment"># On Raspberry Pi replace `amd64` with the appropriate architecture.</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MQTT_HOST=192.168.1.71</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MQTT_USERNAME=rtl</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MQTT_PASSWORD=rtl</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MQTT_PORT=1883</span></span><br><span class="line"><span class="comment">#     - RTL_TOPIC=rtl_433/rtl-433/events</span></span><br><span class="line"><span class="comment">#     - DISCOVERY_PREFIX=homeassistant</span></span><br><span class="line"><span class="comment">#     - DISCOVERY_INTERVAL=30</span></span><br><span class="line"><span class="comment">#      - LOG_LEVEL=debug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">OTHER_ARGS=--retain</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>This service is required for the Home Assistant discovery feature. Use it on demand when you need to add a new device; otherwise, leave it stopped.</p><p>Now, let‚Äôs restart and check the Home Assistant devices list. You should see the weather station and the room sensors available.</p><h3 id="üåü-Enabling-MQTT-Integration-üåü"><a href="#üåü-Enabling-MQTT-Integration-üåü" class="headerlink" title="üåü Enabling MQTT Integration üåü"></a>üåü Enabling MQTT Integration üåü</h3><p>Almost there! üåà Just one last thing: turn on the MQTT integration in Home Assistant. üöÄ Zoom over to the integrations page, add MQTT, and watch as your weather station‚Äôs data flows in like a boss! üòéüìà</p><p>And voil√†! üéâ You‚Äôve leveled up to weather guru status, all while chuckling at the old tech you‚Äôve repurposed. Now, go forth and predict the weather like a pro (or at least dazzle your neighbors)! üßô‚Äç‚ôÇÔ∏èüå¶Ô∏è</p><hr><h2 id="üõ†Ô∏è-Create-Your-Home-Assistant-Dashboard-üõ†Ô∏è"><a href="#üõ†Ô∏è-Create-Your-Home-Assistant-Dashboard-üõ†Ô∏è" class="headerlink" title="üõ†Ô∏è Create Your Home Assistant Dashboard üõ†Ô∏è"></a>üõ†Ô∏è Create Your Home Assistant Dashboard üõ†Ô∏è</h2><p>Add a dashboard in Home Assistant to display all the juicy data from your weather station and the sensors in each room. üè†üå°Ô∏èüíß</p><p><img src="/2024/08/08/The-Day-I-Became-a-Weather-Wizard/weather_screen.gif" alt="Weather dashboard" title="Weather dashboard"></p><hr><h2 id="üåÄ-InfluxDB-2-Configuration-üåÄ"><a href="#üåÄ-InfluxDB-2-Configuration-üåÄ" class="headerlink" title="üåÄ InfluxDB 2 Configuration üåÄ"></a>üåÄ InfluxDB 2 Configuration üåÄ</h2><p>Configure InfluxDB with your user, organization, and bucket. Follow the steps in the images below:</p><p><img src="/2024/08/08/The-Day-I-Became-a-Weather-Wizard/influxdb.png" alt="influxdb" title="influxdb"></p><p>Set up your InfluxDB user and organization name, and configure your bucket:</p><p>![influxdb - configuration](&#x2F;2024&#x2F;08&#x2F;08&#x2F;The-Day-I-Became-a-Weather-Wizard&#x2F;Pasted image 20240805223114.png ‚Äúinfluxdb - configuration‚Äù)</p><p>Next, configure Home Assistant:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">muadib@zigbee:~ $ <span class="built_in">sudo</span> nano home/hass/configuration.yaml</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">influxdb:</span></span><br><span class="line">  <span class="attr">api_version:</span> <span class="number">2</span>  <span class="comment"># Specifies the API version used to communicate with InfluxDB.</span></span><br><span class="line">  <span class="attr">ssl:</span> <span class="literal">false</span>                 <span class="comment"># Determines if SSL (secure connection) is used. &#x27;false&#x27; means no SSL.</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">localhost</span>            <span class="comment"># The hostname or IP address of the InfluxDB server.</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8086</span>                 <span class="comment"># The port number on which InfluxDB is running.</span></span><br><span class="line">  <span class="attr">token:</span> <span class="type">!secret</span> <span class="string">influxdb_token</span> <span class="comment"># Authentication token for accessing InfluxDB, stored securely.</span></span><br><span class="line">  <span class="attr">organization:</span> <span class="string">trollnet</span>      <span class="comment"># The name of the organization in InfluxDB.</span></span><br><span class="line">  <span class="attr">bucket:</span> <span class="string">hass</span>               <span class="comment"># The name of the bucket (database) to store data in InfluxDB.</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="attr">source:</span> <span class="string">ha</span>               <span class="comment"># Adds a tag named &#x27;source&#x27; with the value &#x27;ha&#x27; to all data points.</span></span><br><span class="line">  <span class="attr">tags_attributes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">friendly_name</span>          <span class="comment"># Includes the attribute &#x27;friendly_name&#x27; as a tag in data points.</span></span><br><span class="line">  <span class="attr">default_measurement:</span> <span class="string">units</span> <span class="comment"># Sets a default measurement name for data points when not specified.</span></span><br><span class="line">  <span class="attr">include:</span></span><br><span class="line">    <span class="attr">domains:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">person</span>               <span class="comment"># Specifies to include data from entities in the &#x27;person&#x27; domain.</span></span><br><span class="line">    <span class="attr">entity_globs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">sensor.speedtest*</span>    <span class="comment"># Includes entities that match the pattern &#x27;sensor.speedtest*&#x27;.</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">sensor.ram_use_pct*</span>  <span class="comment"># Includes entities that match the pattern &#x27;sensor.ram_use_pct*&#x27;.</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">sensor.cpu_load*</span>     <span class="comment"># Includes entities that match the pattern &#x27;sensor.cpu_load*&#x27;.</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">sensor.bresser*</span>      <span class="comment"># Includes entities that match the pattern &#x27;sensor.bresser*&#x27;.</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">sensor.nexus*</span>        <span class="comment"># Includes entities that match the pattern &#x27;sensor.nexus*&#x27;.</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>restart home-assistant.</p><h2 id="üìä-Grafana-Setup-üìä"><a href="#üìä-Grafana-Setup-üìä" class="headerlink" title="üìä Grafana Setup üìä"></a>üìä Grafana Setup üìä</h2><h3 id="Bind-Mounts-Optional-üöÄ"><a href="#Bind-Mounts-Optional-üöÄ" class="headerlink" title="Bind Mounts (Optional) üöÄ"></a>Bind Mounts (Optional) üöÄ</h3><p>If you‚Äôre using directories on your host for Grafana‚Äôs database or configuration, start the container with a user who has permission to access and write to the directory you map. üõ†Ô∏è</p><p>Find a user‚Äôs UID or GID in Unix:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">muadib@zigbee:~ $ <span class="built_in">id</span> -u muadib</span><br><span class="line">1000</span><br></pre></td></tr></table></figure><p>Create an <code>.env</code> file:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UID=1000</span><br></pre></td></tr></table></figure><p>Ensure the volume mount folder exists and is owned by the desired user&#x2F;group:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">muadib@zigbee:~/hass-docker $ <span class="built_in">mkdir</span> ../home/grafana</span><br></pre></td></tr></table></figure><p>Configure Grafana and InfluxDB in <code>docker-compose.yml</code>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">grafana:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">grafana/grafana:11.1.1</span></span><br><span class="line">  <span class="attr">container_name:</span> <span class="string">grafana</span></span><br><span class="line">  <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">$&#123;UID&#125;</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">3000</span><span class="string">:3000</span></span><br><span class="line">  <span class="attr">depends_on:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">influxdb</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;/home/muadib/home/grafana:/var/lib/grafana&quot;</span></span><br><span class="line">  <span class="attr">env_file:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">./.env</span></span><br><span class="line">      <span class="attr">required:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">influxdb:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">influxdb:2.7.8-alpine</span></span><br><span class="line">  <span class="attr">container_name:</span> <span class="string">influxdb</span></span><br><span class="line">  <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">8086</span><span class="string">:8086</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">8089</span><span class="string">:8089/udp</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;/home/muadib/home/influxdb:/var/lib/influxdb2&quot;</span></span><br></pre></td></tr></table></figure><p>Check the logs and restart a single container from the Docker Compose setup:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">docker-compose</span> <span class="string">stop</span> <span class="string">-t</span> <span class="number">1</span> <span class="string">grafana</span></span><br><span class="line"><span class="string">docker-compose</span> <span class="string">build</span> <span class="string">grafana</span></span><br><span class="line"><span class="string">docker-compose</span> <span class="string">up</span> <span class="string">--no-start</span> <span class="string">grafana</span></span><br><span class="line"><span class="string">docker-compose</span> <span class="string">start</span> <span class="string">grafana</span></span><br><span class="line"><span class="string">docker-compose</span> <span class="string">logs</span> <span class="string">-f</span> <span class="string">grafana</span></span><br></pre></td></tr></table></figure><hr><h2 id="üåê-Add-InfluxDB-to-Grafana-üåê"><a href="#üåê-Add-InfluxDB-to-Grafana-üåê" class="headerlink" title="üåê Add InfluxDB to Grafana üåê"></a>üåê Add InfluxDB to Grafana üåê</h2><p>Configure InfluxDB as a data source in Grafana:</p><ol><li>Open your web browser and go to Grafana‚Äôs root URL, usually <code>http://localhost:3000</code>. üåê</li><li>On the sign-in page, use <code>admin</code> for both username and password.</li><li>Click <strong>Sign in</strong> and change your password when prompted. üîí</li><li>Go to the data source section and find InfluxDB. üåü</li></ol><p>Generate a new API token in InfluxDB for Grafana:</p><p>![influxdb - configuration](&#x2F;2024&#x2F;08&#x2F;08&#x2F;The-Day-I-Became-a-Weather-Wizard&#x2F;Pasted image 20240803214228.png ‚Äúinfluxdb - configuration‚Äù)</p><hr><h3 id="üìà-Install-the-Wind-Rose-Plugin-üìà"><a href="#üìà-Install-the-Wind-Rose-Plugin-üìà" class="headerlink" title="üìà Install the Wind Rose Plugin üìà"></a>üìà Install the Wind Rose Plugin üìà</h3><ol><li>Clone the plugin repository:<br><code>git clone https://github.com/spectraphilic/grafana-windrose.git</code></li><li>Stop the Grafana-Docker container.</li><li>Manually copy the plugin to <code>/var/lib/grafana/plugins/grafana-windrose</code>.</li><li>Restart the Grafana-Docker container and check the plugin settings. üé®</li></ol><p>Install ECharts for advanced visualizations:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install https://github.com/apache/echarts</span><br></pre></td></tr></table></figure><hr><h2 id="üé®-Crafting-the-Dashboard-üé®"><a href="#üé®-Crafting-the-Dashboard-üé®" class="headerlink" title="üé® Crafting the Dashboard üé®"></a>üé® Crafting the Dashboard üé®</h2><p>Create your dashboard and visualize the data:</p><p>![grafana dashboard](&#x2F;2024&#x2F;08&#x2F;08&#x2F;The-Day-I-Became-a-Weather-Wizard&#x2F;Pasted image 20240805225325.png ‚Äúgrafana dashboard‚Äù)</p><p>Set up a Grafana variable period as shown above:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">environment:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">GF_INSTALL_PLUGINS=volkovlabs-echarts-panel</span>  <span class="comment"># Specifies a Grafana plugin to install (echarts panel by Volkov Labs)</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">GF_DEFAULT_APP_MODE=development</span>              <span class="comment"># Sets the Grafana application mode to development for easier debugging</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">GF_PLUGINS_ALLOW_LOADING_UNSIGNED_PLUGINS=grafana-windrose</span>  <span class="comment"># Allows loading an unsigned plugin (windrose plugin for Grafana)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Design your dashboard like this:</p><p>![grafana dashboard ](&#x2F;2024&#x2F;08&#x2F;08&#x2F;The-Day-I-Became-a-Weather-Wizard&#x2F;Pasted image 20240807200447.png ‚Äúgrafana dashboard‚Äù)</p><hr><h2 id="üå¨Ô∏è-Wind-and-Speed-Direction-Chart-üå¨Ô∏è"><a href="#üå¨Ô∏è-Wind-and-Speed-Direction-Chart-üå¨Ô∏è" class="headerlink" title="üå¨Ô∏è Wind and Speed Direction Chart üå¨Ô∏è"></a>üå¨Ô∏è Wind and Speed Direction Chart üå¨Ô∏è</h2><p>Create the Flux query for wind speed and direction:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">speed = from(bucket: &quot;hass&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; range(start: v.timeRangeStart, stop: v.timeRangeStop)</span><br><span class="line"></span><br><span class="line">  |&gt; filter(fn: (r) =&gt; r[&quot;entity_id&quot;] == &quot;bresser_5in1_254_wind_average&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;value&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; aggregateWindow(every: $&#123;period&#125;, fn: mean, createEmpty: false)</span><br><span class="line"></span><br><span class="line">  |&gt; pivot(rowKey:[&quot;_time&quot;], columnKey: [&quot;entity_id&quot;], valueColumn: &quot;_value&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; rename(columns: &#123;&quot;bresser_5in1_254_wind_average&quot;: &quot;speed&quot;, &quot;_measurement&quot;: &quot;unit&quot;&#125;)</span><br><span class="line"></span><br><span class="line">  |&gt; keep(columns: [&quot;_time&quot;, &quot;speed&quot;, &quot;unit&quot;])</span><br><span class="line"></span><br><span class="line">direction = from(bucket: &quot;hass&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; range(start: v.timeRangeStart, stop: v.timeRangeStop)</span><br><span class="line"></span><br><span class="line">  |&gt; filter(fn: (r) =&gt; r[&quot;entity_id&quot;] == &quot;bresser_5in1_254_wind_direction&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;value&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; aggregateWindow(every: $&#123;period&#125;, fn: mean, createEmpty: false)</span><br><span class="line"></span><br><span class="line">  |&gt; pivot(rowKey:[&quot;_time&quot;], columnKey: [&quot;entity_id&quot;], valueColumn: &quot;_value&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; rename(columns: &#123;&quot;bresser_5in1_254_wind_direction&quot;: &quot;direction&quot;, &quot;_measurement&quot;: &quot;unit&quot;&#125;)</span><br><span class="line"></span><br><span class="line">  |&gt; keep(columns: [&quot;_time&quot;, &quot;direction&quot;, &quot;unit&quot;])</span><br><span class="line"></span><br><span class="line">join(</span><br><span class="line">  tables: &#123;speed, direction&#125;,</span><br><span class="line">  on: [&quot;_time&quot;]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>Create your business dashboard, use the code option for creating a dashboard:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">let wind;</span><br><span class="line"></span><br><span class="line">context.panel.data.series.map((s) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  const time = s.fields.find((f) =&gt; f.name === &#x27;_time&#x27;).values;</span><br><span class="line"></span><br><span class="line">  const value = s.fields.find((f) =&gt; f.name === &#x27;speed&#x27;).values;</span><br><span class="line"></span><br><span class="line">  const rotate = s.fields.find((f) =&gt; f.name === &#x27;direction&#x27;).values;</span><br><span class="line"></span><br><span class="line">  wind = time.map((id, index) =&gt; &#123;</span><br><span class="line">    return &#123; symbolRotate: rotate[index], value: [time[index], value[index]] &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">return &#123;</span><br><span class="line">  xAxis: &#123;</span><br><span class="line">    type: &#x27;time&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  yAxis: &#123;</span><br><span class="line">    type: &#x27;value&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  visualMap: &#123;</span><br><span class="line">    orient: &#x27;horizontal&#x27;,</span><br><span class="line">    left: &#x27;center&#x27;,</span><br><span class="line">    min: 0,</span><br><span class="line">    max: 10,</span><br><span class="line">    text: [&#x27;High&#x27;, &#x27;Low&#x27;],</span><br><span class="line">    dimension: 1,</span><br><span class="line">    inRange: &#123;</span><br><span class="line">      color: [&#x27;#65B581&#x27;, &#x27;#FFCE34&#x27;, &#x27;#FD665F&#x27;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  series: [</span><br><span class="line">    &#123;</span><br><span class="line">      data: wind,</span><br><span class="line">      type: &#x27;line&#x27;,</span><br><span class="line">      symbol: &#x27;path://M31 24.7343L21.7917 24.7343V0L9.20826 0L9.20826 24.7343H0L15.5 45L31 24.7343Z&#x27;,</span><br><span class="line">      symbolSize: 20,</span><br><span class="line">      lineStyle: &#123;</span><br><span class="line">        width: 0.3</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="üå™Ô∏è-Windrose-Visualization-üå™Ô∏è"><a href="#üå™Ô∏è-Windrose-Visualization-üå™Ô∏è" class="headerlink" title="üå™Ô∏è Windrose Visualization üå™Ô∏è"></a>üå™Ô∏è Windrose Visualization üå™Ô∏è</h2><p>Create two queries: one for wind speed and one for wind direction.</p><p>Speed Query:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from(bucket: &quot;hass&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; range(start: v.timeRangeStart, stop: v.timeRangeStop)</span><br><span class="line"></span><br><span class="line">  |&gt; filter(fn: (r) =&gt; r[&quot;entity_id&quot;] == &quot;bresser_5in1_254_wind_average&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;value&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; aggregateWindow(every: $&#123;period&#125;, fn: mean, createEmpty: false)</span><br><span class="line"></span><br><span class="line">  |&gt; pivot(rowKey:[&quot;_time&quot;], columnKey: [&quot;entity_id&quot;], valueColumn: &quot;_value&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; rename(columns: &#123;&quot;bresser_5in1_254_wind_average&quot;: &quot;speed&quot;, &quot;_measurement&quot;: &quot;unit&quot;&#125;)</span><br><span class="line"></span><br><span class="line">  |&gt; keep(columns: [&quot;_time&quot;, &quot;speed&quot;, &quot;unit&quot;])</span><br></pre></td></tr></table></figure><p>Direction Query:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from(bucket: &quot;hass&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; range(start: v.timeRangeStart, stop: v.timeRangeStop)</span><br><span class="line"></span><br><span class="line">  |&gt; filter(fn: (r) =&gt; r[&quot;entity_id&quot;] == &quot;bresser_</span><br><span class="line"></span><br><span class="line">5in1_254_wind_direction&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; filter(fn: (r) =&gt; r[&quot;_field&quot;] == &quot;value&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; aggregateWindow(every: $&#123;period&#125;, fn: mean, createEmpty: false)</span><br><span class="line"></span><br><span class="line">  |&gt; pivot(rowKey:[&quot;_time&quot;], columnKey: [&quot;entity_id&quot;], valueColumn: &quot;_value&quot;)</span><br><span class="line"></span><br><span class="line">  |&gt; rename(columns: &#123;&quot;bresser_5in1_254_wind_direction&quot;: &quot;direction&quot;, &quot;_measurement&quot;: &quot;unit&quot;&#125;)</span><br><span class="line"></span><br><span class="line">  |&gt; keep(columns: [&quot;_time&quot;, &quot;direction&quot;, &quot;unit&quot;])</span><br></pre></td></tr></table></figure><p>Select the windrose chart type:</p><p>![grafana dashboard -windrose ](&#x2F;2024&#x2F;08&#x2F;08&#x2F;The-Day-I-Became-a-Weather-Wizard&#x2F;Pasted image 20240807201501.png ‚Äúgrafana dashboard -windrose‚Äù)</p><hr><h2 id="üèÜ-Conclusion-üèÜ"><a href="#üèÜ-Conclusion-üèÜ" class="headerlink" title="üèÜ Conclusion üèÜ"></a>üèÜ Conclusion üèÜ</h2><p>Armed with your <strong>Bresser Weather Center 5-in-1</strong>, a vintage radio receiver, and a sprinkle of software magic, you‚Äôve created a setup that reads, interprets, and displays weather data like a true wizard. üåü</p><p>Seeing real-time weather updates and having your home respond automatically is nothing short of thrilling. üå¶Ô∏è So, if you‚Äôre up for some weather wizardry, remember: with the right tools and a dash of patience, you too can conjure up some magic. ‚ú®</p><p>Happy weather-watching! üåàüîÆ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;The-Day-I-Became-a-Weather-Wizard-üå©Ô∏èüßô‚Äç‚ôÇÔ∏è&quot;&gt;&lt;a href=&quot;#The-Day-I-Became-a-Weather-Wizard-üå©Ô∏èüßô‚Äç‚ôÇÔ∏è&quot; class=&quot;headerlink&quot; title=&quot;The Day </summary>
      
    
    
    
    
    <category term="Technology" scheme="https://darknessnerd.github.io.git/tags/Technology/"/>
    
    <category term="Home Automation" scheme="https://darknessnerd.github.io.git/tags/Home-Automation/"/>
    
    <category term="IoT" scheme="https://darknessnerd.github.io.git/tags/IoT/"/>
    
    <category term="Smart Home" scheme="https://darknessnerd.github.io.git/tags/Smart-Home/"/>
    
    <category term="Weather Station" scheme="https://darknessnerd.github.io.git/tags/Weather-Station/"/>
    
    <category term="Data Visualization" scheme="https://darknessnerd.github.io.git/tags/Data-Visualization/"/>
    
    <category term="MQTT" scheme="https://darknessnerd.github.io.git/tags/MQTT/"/>
    
    <category term="Grafana" scheme="https://darknessnerd.github.io.git/tags/Grafana/"/>
    
    <category term="InfluxDB" scheme="https://darknessnerd.github.io.git/tags/InfluxDB/"/>
    
    <category term="DIY Projects" scheme="https://darknessnerd.github.io.git/tags/DIY-Projects/"/>
    
  </entry>
  
  <entry>
    <title>Home Assistant: The Smart Home Saga Begins!</title>
    <link href="https://darknessnerd.github.io.git/2024/07/28/Home-Assistant-The-Smart-Home-Saga-Begins/"/>
    <id>https://darknessnerd.github.io.git/2024/07/28/Home-Assistant-The-Smart-Home-Saga-Begins/</id>
    <published>2024-07-28T07:07:21.000Z</published>
    <updated>2024-07-31T07:31:28.808Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Home-Assistant-The-Smart-Home-Saga-Begins"><a href="#Home-Assistant-The-Smart-Home-Saga-Begins" class="headerlink" title="Home-Assistant-The-Smart-Home-Saga-Begins"></a>Home-Assistant-The-Smart-Home-Saga-Begins</h1><h2 id="üìù-Requirement-List"><a href="#üìù-Requirement-List" class="headerlink" title="üìù Requirement List:"></a>üìù Requirement List:</h2><ol><li>üçì <strong>Raspberry Pi</strong> (used 3B+ version for this tutorial)</li><li>üíø <strong>Raspbian OS</strong></li></ol><p>‚ú® <strong>Bonus Magic Tutorial</strong> ‚ú®</p><p>üîÆ If you want to know how to install Raspbian on Pi without a monitor, please follow this<a href="https://darknessnerd.github.io/2024/07/25/The-Invisible-Setup-Installing-Raspbian-on-Raspberry-Pi-Without-a-Monitor/"> <strong>magic tutorial ‚Äì The Invisible Setup: Installing Raspbian on Raspberry Pi Without a Monitor</strong></a>! üßô‚Äç‚ôÇÔ∏è</p><p>Enjoy your Pi adventure! ü•ß</p><h1 id="Part-1-The-Magical-Installation-üßô‚Äç‚ôÇÔ∏è"><a href="#Part-1-The-Magical-Installation-üßô‚Äç‚ôÇÔ∏è" class="headerlink" title="Part 1: The Magical Installation üßô‚Äç‚ôÇÔ∏è"></a>Part 1: The Magical Installation üßô‚Äç‚ôÇÔ∏è</h1><p>Welcome to the world of smart homes! Ready to turn your home into a futuristic paradise? Let‚Äôs kick things off with Home Assistant and Postgres. </p><p>But first, a quick disclaimer: </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If you start talking to your appliances, we‚Äôre not responsible <span class="keyword">for</span> any strange looks from your family members.</span><br></pre></td></tr></table></figure><h2 id="Step-1-Summon-Docker-on-Raspberry-Pi-üê≥"><a href="#Step-1-Summon-Docker-on-Raspberry-Pi-üê≥" class="headerlink" title="Step 1: Summon Docker on Raspberry Pi üê≥"></a>Step 1: Summon Docker on Raspberry Pi üê≥</h2><p>Imagine Docker as the magical suitcase from Mary Poppins. </p><p>It can fit everything you need in one place! </p><p>Here‚Äôs how to get Docker onto your Raspberry Pi:</p><ol><li>Open your terminal.</li><li>Run these magical incantations: <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://get.docker.com -o get-docker.sh</span><br><span class="line"><span class="built_in">sudo</span> sh get-docker.sh</span><br><span class="line"><span class="built_in">sudo</span> usermod -aG docker muadib</span><br></pre></td></tr></table></figure></li></ol><p>Once Docker is installed, grab your Raspberry Pi and do a little celebratory dance. </p><p>You‚Äôve just completed the first step!</p><h2 id="Step-2-Docker-Compose-The-Fellowship-Leader-üßô‚Äç‚ôÇÔ∏è"><a href="#Step-2-Docker-Compose-The-Fellowship-Leader-üßô‚Äç‚ôÇÔ∏è" class="headerlink" title="Step 2: Docker Compose - The Fellowship Leader üßô‚Äç‚ôÇÔ∏è"></a>Step 2: Docker Compose - The Fellowship Leader üßô‚Äç‚ôÇÔ∏è</h2><p>Docker Compose is like the director of an orchestra, making sure all your containers play in harmony. </p><p>Create a file named <code>docker-compose.yml</code> and add the following lines to it:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">homeassistant:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">homeassistant</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&quot;ghcr.io/home-assistant/home-assistant:stable&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/home/muadib/home/hass:/config</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">host</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mosquitto</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">postgres</span></span><br><span class="line">  <span class="attr">postgres:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:16.3-alpine3.20</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5432</span><span class="string">:5432</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/home/muadib/home/postgres:/var/lib/postgresql/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_DB=&lt;db_name&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_USER=&lt;user&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_PASSWORD=&lt;password&gt;</span></span><br></pre></td></tr></table></figure><p>Save it, then run this in your terminal:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up</span><br></pre></td></tr></table></figure><p>Now, take a break. Grab a coffee, pet your cat, or just stare lovingly at your Raspberry Pi as it works its magic.</p><h2 id="Configuration-Explained-üß©"><a href="#Configuration-Explained-üß©" class="headerlink" title="Configuration Explained üß©"></a>Configuration Explained üß©</h2><p>Now that you‚Äôve got Home Assistant and Postgres running, it‚Äôs time to configure them.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose stop</span><br></pre></td></tr></table></figure><p>This is where the real fun begins. Here‚Äôs a breakdown:</p><h3 id="Database-Configuration-üìö"><a href="#Database-Configuration-üìö" class="headerlink" title="Database Configuration üìö"></a>Database Configuration üìö</h3><p>In your <code>configuration.yaml</code> file, add:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">recorder:</span></span><br><span class="line">  <span class="attr">auto_repack:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">purge_keep_days:</span> <span class="number">7</span></span><br><span class="line">  <span class="attr">db_url:</span> <span class="type">!secret</span> <span class="string">psql_string</span></span><br><span class="line">  <span class="attr">db_retry_wait:</span> <span class="number">15</span> <span class="comment"># Wait 15 seconds before retrying</span></span><br><span class="line">  <span class="attr">include:</span></span><br><span class="line">    <span class="attr">domains:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">person</span></span><br><span class="line">    <span class="attr">entity_globs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">sensor.speedtest*</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">sensor.ram_use_pct*</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">sensor.cpu_load*</span></span><br><span class="line"><span class="attr">history:</span></span><br><span class="line"><span class="attr">logbook:</span></span><br></pre></td></tr></table></figure><h4 id="What‚Äôs-Happening-Here"><a href="#What‚Äôs-Happening-Here" class="headerlink" title="What‚Äôs Happening Here?"></a>What‚Äôs Happening Here?</h4><ul><li><strong>auto_repack:</strong> Optimizes the database automatically.</li><li><strong>purge_keep_days:</strong> Keeps only the last 7 days of data. Because who needs to remember what their thermostat was set to three months ago?</li><li><strong>db_url:</strong> This is where the magic happens. The connection string for your Postgres database (we‚Äôll configure this in a bit).</li></ul><h3 id="Secrets-Configuration-üïµÔ∏è‚Äç‚ôÇÔ∏è"><a href="#Secrets-Configuration-üïµÔ∏è‚Äç‚ôÇÔ∏è" class="headerlink" title="Secrets Configuration üïµÔ∏è‚Äç‚ôÇÔ∏è"></a>Secrets Configuration üïµÔ∏è‚Äç‚ôÇÔ∏è</h3><p>To keep your secrets safe (because, let‚Äôs face it, we all have them), create a <code>secrets.yaml</code> file and add:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">psql_string:</span> <span class="string">&quot;postgresql://&lt;user&gt;:&lt;password&gt;@192.168.0.XXX/&lt;db_name&gt;&quot;</span></span><br></pre></td></tr></table></figure><p>Replace <code>PASSWORD</code> and <code>192.168.0.XXX</code> with your actual password and IP address.</p><h2 id="Enable-Integrations-from-the-Home-Assistant-UI"><a href="#Enable-Integrations-from-the-Home-Assistant-UI" class="headerlink" title="Enable Integrations from the Home Assistant UI"></a>Enable Integrations from the Home Assistant UI</h2><p>Run:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p>Now, let‚Äôs make Home Assistant actually do something!</p><p><img src="/2024/07/28/Home-Assistant-The-Smart-Home-Saga-Begins/hass-ui.png" alt="homeassistant home" title="Hass Home"></p><p>Confgure it and enjoy your journey!!</p><p><img src="/2024/07/28/Home-Assistant-The-Smart-Home-Saga-Begins/hass-ui-config.png" alt="homeassistant home" title="Hass Home"></p><p>Enable some first sensors like:</p><ol><li><strong>Speedtest Integration:</strong> Navigate to the integrations page and enable the Speedtest integration. No more guessing if your internet is slow because of the weather or because your neighbor is downloading every season of their favorite show.</li></ol><p><img src="/2024/07/28/Home-Assistant-The-Smart-Home-Saga-Begins/speedtest.png" alt="homeassistant home" title="Hass Home"></p><ol start="2"><li><strong>System Monitoring:</strong> Enable system monitoring metrics by going to <code>config/integrations/integration/systemmonitor</code>. Pick the metrics you care about and add them to your dashboard.</li></ol><p><img src="/2024/07/28/Home-Assistant-The-Smart-Home-Saga-Begins/sensors-example.png" alt="homeassistant home" title="Hass Home"></p><p>Here‚Äôs a sneak peek at what your first dashboard might look like:</p><p><img src="/2024/07/28/Home-Assistant-The-Smart-Home-Saga-Begins/dashboard.png" alt="Dashboard System monitor" title="System monitor"></p><p>If you‚Äôre interested in learning how to create the dashboard or theme, please leave a comment on this blog.</p><h2 id="Coming-Up-Next"><a href="#Coming-Up-Next" class="headerlink" title="Coming Up Next"></a>Coming Up Next</h2><p>In the next tutorial, we‚Äôll dive into capturing data from RTL weather stations and sensors for humidity and temperature. We‚Äôll also explore frequencies like 400 MHz and 800 MHz. </p><p>So stay tuned, because your smart home journey is just beginning!</p><p>Until next time, happy automating! üöÄ</p><hr><p>Feel free to share your progress and any questions in the comments below. </p><p>Let‚Äôs make our homes smarter together!</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Home-Assistant-The-Smart-Home-Saga-Begins&quot;&gt;&lt;a href=&quot;#Home-Assistant-The-Smart-Home-Saga-Begins&quot; class=&quot;headerlink&quot; title=&quot;Home-Assis</summary>
      
    
    
    
    
    <category term="Raspbian" scheme="https://darknessnerd.github.io.git/tags/Raspbian/"/>
    
    <category term="DIY" scheme="https://darknessnerd.github.io.git/tags/DIY/"/>
    
    <category term="Docker" scheme="https://darknessnerd.github.io.git/tags/Docker/"/>
    
    <category term="HomeAutomation" scheme="https://darknessnerd.github.io.git/tags/HomeAutomation/"/>
    
  </entry>
  
  <entry>
    <title>The Invisible Setup: Installing Raspbian on Raspberry Pi Without a Monitor</title>
    <link href="https://darknessnerd.github.io.git/2024/07/25/The-Invisible-Setup-Installing-Raspbian-on-Raspberry-Pi-Without-a-Monitor/"/>
    <id>https://darknessnerd.github.io.git/2024/07/25/The-Invisible-Setup-Installing-Raspbian-on-Raspberry-Pi-Without-a-Monitor/</id>
    <published>2024-07-25T21:26:58.000Z</published>
    <updated>2024-07-25T21:29:17.933Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Installing-Raspbian-on-Raspberry-Pi-Without-a-Monitor-A-Journey-of-Technological-Hijinks"><a href="#Installing-Raspbian-on-Raspberry-Pi-Without-a-Monitor-A-Journey-of-Technological-Hijinks" class="headerlink" title="Installing Raspbian on Raspberry Pi Without a Monitor: A Journey of Technological Hijinks"></a>Installing Raspbian on Raspberry Pi Without a Monitor: A Journey of Technological Hijinks</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Welcome, fellow tech enthusiasts, to the wild and wacky world of headless Raspberry Pi setup! Today, we‚Äôre diving into the delightful chaos of installing Raspbian on a Raspberry Pi without a monitor. Buckle up, because this is going to be a fun ride!</p><h2 id="What-You‚Äôll-Need"><a href="#What-You‚Äôll-Need" class="headerlink" title="What You‚Äôll Need"></a>What You‚Äôll Need</h2><p>Before we get started, here‚Äôs a quick checklist of what you‚Äôll need:</p><ul><li>A Raspberry Pi (any model will do, but let‚Äôs go with the Raspberry Pi 4 for this adventure).</li><li>A microSD card (at least 8GB, but the bigger, the better).</li><li>A microSD card reader.</li><li>A computer with internet access.</li><li>A power supply for your Raspberry Pi.</li><li>An Ethernet cable (optional, but recommended for a smoother experience).</li></ul><h2 id="Step-1-Download-Raspbian"><a href="#Step-1-Download-Raspbian" class="headerlink" title="Step 1: Download Raspbian"></a>Step 1: Download Raspbian</h2><p>First things first, let‚Äôs get our hands on the latest Raspbian image. Head over to the <a href="https://www.raspberrypi.org/software/operating-systems/">official Raspberry Pi website</a> and download the Raspbian image. We recommend the ‚ÄúRaspberry Pi OS with desktop‚Äù version because, why not?</p><h2 id="Step-2-Flash-the-Image-to-the-SD-Card"><a href="#Step-2-Flash-the-Image-to-the-SD-Card" class="headerlink" title="Step 2: Flash the Image to the SD Card"></a>Step 2: Flash the Image to the SD Card</h2><p>Next, we need to flash the Raspbian image onto the microSD card. To do this, you can use a handy tool called <a href="https://www.balena.io/etcher/">balenaEtcher</a>.</p><ol><li>Download and install balenaEtcher.</li><li>Insert your microSD card into your card reader and connect it to your computer.</li><li>Open balenaEtcher, select the Raspbian image you downloaded, choose your microSD card, and hit ‚ÄúFlash!‚Äù.</li><li>Wait for the process to complete. This might take a few minutes, so feel free to grab a coffee or do a quick dance.</li></ol><h2 id="Step-3-Enable-SSH-and-Wi-Fi-The-Secret-Sauce"><a href="#Step-3-Enable-SSH-and-Wi-Fi-The-Secret-Sauce" class="headerlink" title="Step 3: Enable SSH and Wi-Fi (The Secret Sauce)"></a>Step 3: Enable SSH and Wi-Fi (The Secret Sauce)</h2><p>Here comes the magical part that makes this whole headless setup possible.</p><ol><li>Once the flashing is complete, remove and reinsert the microSD card into your computer.</li><li>Open the microSD card in your file explorer. You should see a bunch of files and folders.</li><li>Create a new empty file in the root of the microSD card and name it <code>ssh</code> (no file extension). This will enable SSH on your Raspberry Pi.</li><li>Next, create a file called <code>wpa_supplicant.conf</code> and add the following content to configure your Wi-Fi:</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">country=US</span><br><span class="line">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev</span><br><span class="line">update_config=1</span><br><span class="line"></span><br><span class="line">network=&#123;</span><br><span class="line"> ssid=&quot;YourNetworkName&quot;</span><br><span class="line"> psk=&quot;YourNetworkPassword&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Replace <code>YourNetworkName</code> and <code>YourNetworkPassword</code> with your actual Wi-Fi credentials.</p><h2 id="Step-4-Boot-Up-Your-Raspberry-Pi"><a href="#Step-4-Boot-Up-Your-Raspberry-Pi" class="headerlink" title="Step 4: Boot Up Your Raspberry Pi"></a>Step 4: Boot Up Your Raspberry Pi</h2><p>Now it‚Äôs time to bring your Raspberry Pi to life!</p><ol><li>Insert the microSD card into your Raspberry Pi.</li><li>Connect the power supply to your Raspberry Pi.</li><li>If you‚Äôre using an Ethernet cable, connect it now.</li></ol><p>Give it a minute or two to boot up and connect to your Wi-Fi network.</p><h2 id="Step-5-Find-Your-Raspberry-Pi‚Äôs-IP-Address"><a href="#Step-5-Find-Your-Raspberry-Pi‚Äôs-IP-Address" class="headerlink" title="Step 5: Find Your Raspberry Pi‚Äôs IP Address"></a>Step 5: Find Your Raspberry Pi‚Äôs IP Address</h2><p>To SSH into your Raspberry Pi, you need its IP address. There are a few ways to find it:</p><ul><li>Check your router‚Äôs device list for a new device.</li><li>Use a network scanning tool like <a href="https://angryip.org/">Angry IP Scanner</a>.</li></ul><h2 id="Step-6-SSH-into-Your-Raspberry-Pi"><a href="#Step-6-SSH-into-Your-Raspberry-Pi" class="headerlink" title="Step 6: SSH into Your Raspberry Pi"></a>Step 6: SSH into Your Raspberry Pi</h2><p>Once you have the IP address, open a terminal (or Command Prompt on Windows) and type the following command:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh pi@&lt;YourPiIPAddress&gt;</span><br></pre></td></tr></table></figure><p>Replace <code>&lt;YourPiIPAddress&gt;</code> with the actual IP address of your Raspberry Pi.</p><p>The default password for the <code>pi</code> user is <code>raspberry</code>. Once you‚Äôre in, change the password to something more secure using the <code>passwd</code> command.</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>And there you have it! You‚Äôve successfully installed Raspbian on your Raspberry Pi without using a monitor. Welcome to the headless club!</p><p>Feel free to explore and tinker with your newly set up Raspberry Pi. The possibilities are endless, and the fun has just begun!</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Installing-Raspbian-on-Raspberry-Pi-Without-a-Monitor-A-Journey-of-Technological-Hijinks&quot;&gt;&lt;a href=&quot;#Installing-Raspbian-on-Raspberry</summary>
      
    
    
    
    
    <category term="Raspbian" scheme="https://darknessnerd.github.io.git/tags/Raspbian/"/>
    
    <category term="Raspberry Pi" scheme="https://darknessnerd.github.io.git/tags/Raspberry-Pi/"/>
    
    <category term="Headless Setup" scheme="https://darknessnerd.github.io.git/tags/Headless-Setup/"/>
    
    <category term="DIY Tech" scheme="https://darknessnerd.github.io.git/tags/DIY-Tech/"/>
    
    <category term="Fun with Pi" scheme="https://darknessnerd.github.io.git/tags/Fun-with-Pi/"/>
    
  </entry>
  
  <entry>
    <title>Container Wonderland: Running Open-WebUI and Ollama Smoothly</title>
    <link href="https://darknessnerd.github.io.git/2024/07/18/Container-Wonderland-Running-Open-WebUI-and-Ollama-Smoothly/"/>
    <id>https://darknessnerd.github.io.git/2024/07/18/Container-Wonderland-Running-Open-WebUI-and-Ollama-Smoothly/</id>
    <published>2024-07-18T21:29:22.000Z</published>
    <updated>2024-07-18T21:32:58.464Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Running-Open-WebUI-with-Docker-A-Comprehensive-Guide"><a href="#Running-Open-WebUI-with-Docker-A-Comprehensive-Guide" class="headerlink" title="Running Open-WebUI with Docker: A Comprehensive Guide"></a>Running Open-WebUI with Docker: A Comprehensive Guide</h2><p>If you‚Äôre looking to deploy Open-WebUI and Ollama using Docker, you‚Äôre in the right place. Docker is a powerful tool for containerization that allows developers to package applications and their dependencies into a single unit, ensuring consistency across different environments. This guide will walk you through the process of running Open-WebUI and Ollama using Docker commands.</p><h3 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h3><p>Before we begin, make sure you have the following installed on your machine:</p><ol><li><strong>Docker</strong>: You can download and install Docker from <a href="https://www.docker.com/products/docker-desktop">here</a>.</li><li><strong>Basic Knowledge of Docker</strong>: Familiarity with Docker commands and concepts will be helpful.</li></ol><h3 id="Step-1-Running-Open-WebUI"><a href="#Step-1-Running-Open-WebUI" class="headerlink" title="Step 1: Running Open-WebUI"></a>Step 1: Running Open-WebUI</h3><p>First, let‚Äôs run the Open-WebUI container. The command below does the following:</p><ul><li><strong>Adds a host entry</strong> (<code>--add-host=host.docker.internal:host-gateway</code>): This maps the host IP address to <code>host.docker.internal</code> within the container.</li><li><strong>Maps Ports</strong> (<code>-p 8181:8080</code> and <code>-p 3000:8181</code>): The container‚Äôs port 8080 is mapped to host port 8181, and the container‚Äôs port 8181 is mapped to host port 3000.</li><li><strong>Mounts a Volume</strong> (<code>-v open-webui:/app/backend/data</code>): This creates a named volume <code>open-webui</code> and mounts it to <code>/app/backend/data</code> in the container, allowing data persistence.</li><li><strong>Sets Environment Variables</strong> (<code>-e OLLAMA_BASE_URL=http://localhost:11434</code> and <code>-e MAIN_LOG_LEVEL=debug</code>): Configures the base URL for Ollama and sets the logging level to debug.</li><li><strong>Names the Container</strong> (<code>--name open-webui</code>): Assigns the name <code>open-webui</code> to the container.</li><li><strong>Specifies the Image</strong> (<code>ghcr.io/open-webui/open-webui:main</code>): Uses the Open-WebUI image from the GitHub Container Registry.</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --add-host=host.docker.internal:host-gateway -p 8181:8080 -v open-webui:/app/backend/data -p 3000:8181 -e OLLAMA_BASE_URL=http://localhost:11434 -e MAIN_LOG_LEVEL=debug --name open-webui ghcr.io/open-webui/open-webui:main</span><br></pre></td></tr></table></figure><h3 id="Step-2-Running-Ollama"><a href="#Step-2-Running-Ollama" class="headerlink" title="Step 2: Running Ollama"></a>Step 2: Running Ollama</h3><p>Next, let‚Äôs run the Ollama container. This command does the following:</p><ul><li><strong>Runs the Container in Detached Mode</strong> (<code>-d</code>): The container runs in the background.</li><li><strong>Mounts a Volume</strong> (<code>-v ollama:/.ollama</code>): Creates a named volume <code>ollama</code> and mounts it to <code>/.ollama</code> in the container, ensuring data persistence.</li><li><strong>Maps Ports</strong> (<code>-p 11434:11434</code>): The container‚Äôs port 11434 is mapped to the same port on the host.</li><li><strong>Names the Container</strong> (<code>--name ollama</code>): Assigns the name <code>ollama</code> to the container.</li><li><strong>Specifies the Image</strong> (<code>ollama/ollama</code>): Uses the Ollama image.</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -v ollama:/.ollama -p 11434:11434 --name ollama ollama/ollama</span><br></pre></td></tr></table></figure><h3 id="Verifying-the-Setup"><a href="#Verifying-the-Setup" class="headerlink" title="Verifying the Setup"></a>Verifying the Setup</h3><p>After running the above commands, verify that the containers are running smoothly:</p><ol><li><p><strong>List Running Containers</strong>:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><p>You should see both <code>open-webui</code> and <code>ollama</code> containers listed.</p></li><li><p><strong>Access Open-WebUI</strong>:<br>Open your browser and navigate to <code>http://localhost:8181</code> to access Open-WebUI.</p></li><li><p><strong>Check Logs</strong>:<br>To check the logs for troubleshooting, use:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker logs open-webui</span><br><span class="line">docker logs ollama</span><br></pre></td></tr></table></figure></li></ol><h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>By following this guide, you have successfully set up and run Open-WebUI and Ollama using Docker. This setup allows you to leverage containerization for a consistent and portable development environment. Feel free to explore further customizations and configurations to suit your specific needs.</p><p>Happy Dockering!</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Running-Open-WebUI-with-Docker-A-Comprehensive-Guide&quot;&gt;&lt;a href=&quot;#Running-Open-WebUI-with-Docker-A-Comprehensive-Guide&quot; class=&quot;headerl</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Torrenting for the Lazy: Deluge + Docker = Minimal Effort</title>
    <link href="https://darknessnerd.github.io.git/2024/07/17/Torrenting-for-the-Lazy-Deluge-Docker-Minimal-Effort/"/>
    <id>https://darknessnerd.github.io.git/2024/07/17/Torrenting-for-the-Lazy-Deluge-Docker-Minimal-Effort/</id>
    <published>2024-07-16T22:59:45.000Z</published>
    <updated>2024-07-16T23:02:26.699Z</updated>
    
    <content type="html"><![CDATA[<p>Managing torrents is much easier with Docker. This guide will show you how to set up Deluge, a popular BitTorrent client, using Docker Compose. By the end, you‚Äôll have a fully functional Deluge setup running in a Docker container, making torrent management simple and quick.</p><h2 id="What-is-Docker-Compose"><a href="#What-is-Docker-Compose" class="headerlink" title="What is Docker Compose?"></a>What is Docker Compose?</h2><p>Docker Compose is a tool that allows you to define and run multi-container Docker applications. With a single command, you can start all the services from your configuration file.</p><h2 id="Why-Choose-Deluge"><a href="#Why-Choose-Deluge" class="headerlink" title="Why Choose Deluge?"></a>Why Choose Deluge?</h2><p>Deluge is a powerful, lightweight BitTorrent client that works across various platforms. It has a rich collection of plugins and supports many configurations, making it a favorite among torrent users.</p><h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>Before starting, make sure you have:</p><ol><li>Docker installed.</li><li>Docker Compose installed.</li><li>A basic understanding of Docker and container concepts.</li></ol><h2 id="Docker-Compose-Configuration"><a href="#Docker-Compose-Configuration" class="headerlink" title="Docker Compose Configuration"></a>Docker Compose Configuration</h2><p>Here‚Äôs a basic Docker Compose configuration for Deluge:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;2.1&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">deluge:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">linuxserver/deluge:2.1.1</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">deluge</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PUID=1000</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PGID=1000</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Etc/UTC</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DELUGE_LOGLEVEL=error</span> <span class="comment"># optional</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/media/media0/deluge/config:/config</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/media/media0/deluge/downloads:/downloads</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8112</span><span class="string">:8112</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6881</span><span class="string">:6881</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">6881</span><span class="string">:6881/udp</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br></pre></td></tr></table></figure><h3 id="Configuration-Breakdown"><a href="#Configuration-Breakdown" class="headerlink" title="Configuration Breakdown"></a>Configuration Breakdown</h3><ul><li><code>version: &quot;2.1&quot;</code>: Specifies the Docker Compose file version.</li><li><code>services</code>: Lists the services to be deployed.</li><li><code>deluge</code>: The Deluge service.<ul><li><code>image</code>: The Docker image to use, here it‚Äôs <code>linuxserver/deluge:2.1.1</code>.</li><li><code>container_name</code>: Names the container for easier management.</li><li><code>environment</code>: Sets environment variables:<ul><li><code>PUID=1000</code> and <code>PGID=1000</code>: User and group IDs for permissions.</li><li><code>TZ=Etc/UTC</code>: Timezone.</li><li><code>DELUGE_LOGLEVEL=error</code>: Optional log level.</li></ul></li><li><code>volumes</code>: Maps host directories to container directories:<ul><li><code>/media/media0/deluge/config:/config</code>: For configuration files.</li><li><code>/media/media0/deluge/downloads:/downloads</code>: For downloaded files.</li></ul></li><li><code>ports</code>: Maps host ports to container ports:<ul><li><code>8112:8112</code>: Web UI port.</li><li><code>6881:6881</code> and <code>6881:6881/udp</code>: Torrent ports.</li></ul></li><li><code>restart: unless-stopped</code>: Automatically restarts the container unless stopped manually.</li></ul></li></ul><h2 id="Setting-Up-Deluge"><a href="#Setting-Up-Deluge" class="headerlink" title="Setting Up Deluge"></a>Setting Up Deluge</h2><ol><li><p><strong>Create the Directory Structure</strong>: Make sure the directories in the <code>volumes</code> section exist:</p> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /media/media0/deluge/config</span><br><span class="line"><span class="built_in">mkdir</span> -p /media/media0/deluge/downloads</span><br></pre></td></tr></table></figure></li><li><p><strong>Run Docker Compose</strong>: Navigate to the directory with your <code>docker-compose.yml</code> file and run:</p> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p> The <code>-d</code> flag runs the containers in detached mode.</p></li><li><p><strong>Access the Deluge Web UI</strong>: Open your web browser and go to <code>http://&lt;your-server-ip&gt;:8112</code>. You should see the Deluge web interface.</p></li><li><p><strong>Default Password</strong>: The default password is <code>deluge</code>. Change it in the settings for security.</p></li></ol><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Setting up Deluge with Docker Compose is easy and efficient. This setup lets you manage your torrents effortlessly, providing a smooth experience. Docker simplifies the deployment process and keeps your system organized.</p><p>Feel free to customize the Docker Compose file to meet your specific needs. Happy torrenting!</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Managing torrents is much easier with Docker. This guide will show you how to set up Deluge, a popular BitTorrent client, using Docker Co</summary>
      
    
    
    
    
    <category term="Docker" scheme="https://darknessnerd.github.io.git/tags/Docker/"/>
    
    <category term="Docker Compose" scheme="https://darknessnerd.github.io.git/tags/Docker-Compose/"/>
    
    <category term="Deluge" scheme="https://darknessnerd.github.io.git/tags/Deluge/"/>
    
    <category term="BitTorrent" scheme="https://darknessnerd.github.io.git/tags/BitTorrent/"/>
    
    <category term="Torrent Management" scheme="https://darknessnerd.github.io.git/tags/Torrent-Management/"/>
    
  </entry>
  
  <entry>
    <title>Serial Thrillers: Bash Script for USB Identification</title>
    <link href="https://darknessnerd.github.io.git/2024/07/17/Serial-Thrillers-Bash-Script-for-USB-Identification/"/>
    <id>https://darknessnerd.github.io.git/2024/07/17/Serial-Thrillers-Bash-Script-for-USB-Identification/</id>
    <published>2024-07-16T22:02:13.000Z</published>
    <updated>2024-07-16T22:45:08.246Z</updated>
    
    <content type="html"><![CDATA[<p>If you need to identify USB devices connected to your Linux system, it can be a tedious process involving multiple commands and parsing all the lengthy outputs. </p><p>Automation can simplify this task significantly.</p><p>In this post, we‚Äôll walk through a Bash script designed to list all USB devices connected to your system along with their serial numbers.</p><h4 id="The-Script"><a href="#The-Script" class="headerlink" title="The Script"></a>The Script</h4><p>Here‚Äôs the script in question:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> sysdevpath <span class="keyword">in</span> $(find /sys/bus/usb/devices/usb*/ -name dev); <span class="keyword">do</span></span><br><span class="line">    (</span><br><span class="line">        syspath=<span class="string">&quot;<span class="variable">$&#123;sysdevpath%/dev&#125;</span>&quot;</span></span><br><span class="line">        devname=<span class="string">&quot;<span class="subst">$(udevadm info -q name -p $syspath)</span>&quot;</span></span><br><span class="line">        [[ <span class="string">&quot;<span class="variable">$devname</span>&quot;</span> == <span class="string">&quot;bus/&quot;</span>* ]]</span><br><span class="line">        <span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(udevadm info -q property --export -p $syspath)</span>&quot;</span></span><br><span class="line">        [[ -z <span class="string">&quot;<span class="variable">$ID_SERIAL</span>&quot;</span> ]]</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;/dev/<span class="variable">$devname</span> - <span class="variable">$ID_SERIAL</span>&quot;</span></span><br><span class="line">    )</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h4 id="Understanding-the-Script"><a href="#Understanding-the-Script" class="headerlink" title="Understanding the Script"></a>Understanding the Script</h4><p>Let‚Äôs break down what this script does step by step:</p><ol><li><p><strong>Finding USB Devices</strong>: The script starts by finding all device paths under <code>/sys/bus/usb/devices/usb*/</code> that end with <code>dev</code>. This path contains directories and files representing USB devices and their attributes.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> sysdevpath <span class="keyword">in</span> $(find /sys/bus/usb/devices/usb*/ -name dev); <span class="keyword">do</span></span><br></pre></td></tr></table></figure></li><li><p><strong>Extracting the Syspath</strong>: For each device path found, it extracts the parent directory path (<code>syspath</code>) by removing the trailing <code>/dev</code> part.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">syspath=<span class="string">&quot;<span class="variable">$&#123;sysdevpath%/dev&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>Getting the Device Name</strong>: The script uses <code>udevadm info</code> to query the device name corresponding to the syspath. This command provides details about the device.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">devname=<span class="string">&quot;<span class="subst">$(udevadm info -q name -p $syspath)</span>&quot;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>Filtering Out Non-USB Devices</strong>: The script checks if the device name starts with ‚Äúbus&#x2F;‚Äú and skips such devices since they‚Äôre not actual USB devices.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="string">&quot;<span class="variable">$devname</span>&quot;</span> == <span class="string">&quot;bus/&quot;</span>* ]]</span><br></pre></td></tr></table></figure></li><li><p><strong>Exporting Device Properties</strong>: It then uses <code>udevadm info</code> again to export all properties of the device into the current shell environment. This makes properties like <code>ID_SERIAL</code> available as shell variables.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(udevadm info -q property --export -p $syspath)</span>&quot;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>Checking Serial Number</strong>: The script verifies if <code>ID_SERIAL</code> is set. If it‚Äôs not, it continues to the next iteration. This ensures only devices with a serial number are considered.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[ -z <span class="string">&quot;<span class="variable">$ID_SERIAL</span>&quot;</span> ]]</span><br></pre></td></tr></table></figure></li><li><p><strong>Outputting the Device Information</strong>: Finally, the script prints the device‚Äôs path (<code>/dev/$devname</code>) along with its serial number (<code>$ID_SERIAL</code>).</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;/dev/<span class="variable">$devname</span> - <span class="variable">$ID_SERIAL</span>&quot;</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="Running-the-Script"><a href="#Running-the-Script" class="headerlink" title="Running the Script"></a>Running the Script</h4><p>To use this script, save it to a file, for example <code>list_usb_devices.sh</code>, and give it execute permissions:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x list_usb_devices.sh</span><br></pre></td></tr></table></figure><p>Run the script with:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./list_usb_devices.sh</span><br></pre></td></tr></table></figure><p>This will output a list of all connected USB devices and their serial numbers, like this:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/dev/sda1 - 1234567890</span><br><span class="line">/dev/sdb1 - 0987654321</span><br></pre></td></tr></table></figure><h4 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h4><p>This Bash script offers an approach to identify USB devices and their serial numbers on a Linux system. It‚Äôs based on <code>udevadm</code> to gather information about each device. By automating this process, you can save time and reduce the complexity involved in managing USB devices.</p><p>Feel free to adapt and expand this script based on your specific requirements. Happy scripting!</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;If you need to identify USB devices connected to your Linux system, it can be a tedious process involving multiple commands and parsing a</summary>
      
    
    
    
    
    <category term="Bash Scripting" scheme="https://darknessnerd.github.io.git/tags/Bash-Scripting/"/>
    
    <category term="Linux Automation" scheme="https://darknessnerd.github.io.git/tags/Linux-Automation/"/>
    
    <category term="USB Device Management" scheme="https://darknessnerd.github.io.git/tags/USB-Device-Management/"/>
    
    <category term="udevadm" scheme="https://darknessnerd.github.io.git/tags/udevadm/"/>
    
    <category term="System Administration" scheme="https://darknessnerd.github.io.git/tags/System-Administration/"/>
    
  </entry>
  
  <entry>
    <title>Blogging for Dummies: Hexo GitHub Pages Edition</title>
    <link href="https://darknessnerd.github.io.git/2024/07/15/Blogging-for-Dummies-Hexo-GitHub-Pages-Edition/"/>
    <id>https://darknessnerd.github.io.git/2024/07/15/Blogging-for-Dummies-Hexo-GitHub-Pages-Edition/</id>
    <published>2024-07-15T21:45:49.000Z</published>
    <updated>2024-07-16T21:54:41.765Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Step-by-Step-Guide-to-Create-a-Hexo-GitHub-Pages-Blog"><a href="#Step-by-Step-Guide-to-Create-a-Hexo-GitHub-Pages-Blog" class="headerlink" title="Step-by-Step Guide to Create a Hexo GitHub Pages Blog"></a>Step-by-Step Guide to Create a Hexo GitHub Pages Blog</h1><p>Hexo is a fast, simple, and powerful blogging framework. This guide will walk you through the process of creating a Hexo blog and deploying it to GitHub Pages.</p><h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>Before you begin, make sure you have the following installed:</p><ol><li><a href="https://nodejs.org/">Node.js</a></li><li><a href="https://git-scm.com/">Git</a></li></ol><h2 id="Step-1-Install-Hexo"><a href="#Step-1-Install-Hexo" class="headerlink" title="Step 1: Install Hexo"></a>Step 1: Install Hexo</h2><p>Open your terminal and run the following command to install Hexo globally:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><h2 id="Step-2-Set-Up-Your-Blog"><a href="#Step-2-Set-Up-Your-Blog" class="headerlink" title="Step 2: Set Up Your Blog"></a>Step 2: Set Up Your Blog</h2><p>Create a new directory for your blog and navigate into it:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> my-blog</span><br><span class="line"><span class="built_in">cd</span> my-blog</span><br></pre></td></tr></table></figure><p>Initialize a new Hexo project:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><h2 id="Step-3-Configure-Your-Blog"><a href="#Step-3-Configure-Your-Blog" class="headerlink" title="Step 3: Configure Your Blog"></a>Step 3: Configure Your Blog</h2><p>Open the <code>_config.yml</code> file in the root of your Hexo project with a text editor and configure your blog settings. Pay special attention to the <code>url</code>, <code>title</code>, and <code>author</code> settings.</p><h2 id="Step-4-Create-a-New-Post"><a href="#Step-4-Create-a-New-Post" class="headerlink" title="Step 4: Create a New Post"></a>Step 4: Create a New Post</h2><p>You can create a new blog post using the following command:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new post <span class="string">&quot;My First Post&quot;</span></span><br></pre></td></tr></table></figure><p>This will create a new Markdown file in the <code>source/_posts</code> directory. Open this file and edit your post.</p><h2 id="Step-5-Generate-Static-Files"><a href="#Step-5-Generate-Static-Files" class="headerlink" title="Step 5: Generate Static Files"></a>Step 5: Generate Static Files</h2><p>Generate the static files for your blog:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo generate</span><br></pre></td></tr></table></figure><p>You can preview your blog locally by running:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></table></figure><p>Open <a href="http://localhost:4000/">http://localhost:4000</a> in your browser to see your blog.</p><h2 id="Step-6-Deploy-to-GitHub-Pages"><a href="#Step-6-Deploy-to-GitHub-Pages" class="headerlink" title="Step 6: Deploy to GitHub Pages"></a>Step 6: Deploy to GitHub Pages</h2><h3 id="Create-a-GitHub-Repository"><a href="#Create-a-GitHub-Repository" class="headerlink" title="Create a GitHub Repository"></a>Create a GitHub Repository</h3><ol><li>Go to <a href="https://github.com/">GitHub</a> and create a new repository named <code>username.github.io</code>, where <code>username</code> is your GitHub username.</li></ol><h3 id="Install-Hexo-Deployer"><a href="#Install-Hexo-Deployer" class="headerlink" title="Install Hexo Deployer"></a>Install Hexo Deployer</h3><p>Install the Hexo deployer for GitHub Pages:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><h3 id="Configure-Deployment-Settings"><a href="#Configure-Deployment-Settings" class="headerlink" title="Configure Deployment Settings"></a>Configure Deployment Settings</h3><p>Open the <code>_config.yml</code> file again and add the following deployment settings at the bottom:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/username/username.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br></pre></td></tr></table></figure><p>Replace <code>username</code> with your GitHub username.</p><h3 id="Deploy-Your-Blog"><a href="#Deploy-Your-Blog" class="headerlink" title="Deploy Your Blog"></a>Deploy Your Blog</h3><p>Run the following command to deploy your blog to GitHub Pages:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy</span><br></pre></td></tr></table></figure><h2 id="Step-7-Visit-Your-Blog"><a href="#Step-7-Visit-Your-Blog" class="headerlink" title="Step 7: Visit Your Blog"></a>Step 7: Visit Your Blog</h2><p>Open your browser and navigate to <code>https://username.github.io</code> to see your live blog.</p><h2 id="Optional-Customize-Your-Theme"><a href="#Optional-Customize-Your-Theme" class="headerlink" title="Optional: Customize Your Theme"></a>Optional: Customize Your Theme</h2><p>Hexo supports a variety of themes. You can find themes in the <a href="https://hexo.io/themes/">Hexo Themes</a> gallery. To install a theme:</p><ol><li>Download the theme and unzip it into the <code>themes</code> directory of your Hexo project.</li><li>Update the <code>_config.yml</code> file to set the <code>theme</code> value to the name of your new theme.</li><li>Customize the theme settings as needed.</li></ol><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>You have successfully created and deployed a Hexo blog on GitHub Pages. Happy blogging!</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Step-by-Step-Guide-to-Create-a-Hexo-GitHub-Pages-Blog&quot;&gt;&lt;a href=&quot;#Step-by-Step-Guide-to-Create-a-Hexo-GitHub-Pages-Blog&quot; class=&quot;heade</summary>
      
    
    
    
    
    <category term="Hexo" scheme="https://darknessnerd.github.io.git/tags/Hexo/"/>
    
    <category term="GitHub Pages" scheme="https://darknessnerd.github.io.git/tags/GitHub-Pages/"/>
    
    <category term="blogging" scheme="https://darknessnerd.github.io.git/tags/blogging/"/>
    
    <category term="Node.js" scheme="https://darknessnerd.github.io.git/tags/Node-js/"/>
    
    <category term="Git" scheme="https://darknessnerd.github.io.git/tags/Git/"/>
    
  </entry>
  
</feed>
